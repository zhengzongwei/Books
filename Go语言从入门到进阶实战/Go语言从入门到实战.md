# Go语言从入门到实战

## 1. Go语言基本语法与使用

### 1.1 变量

#### 1.1.1 声明变量

变量声明的格式

1. 标准格式

    ```go
    var 变量名 变量类型
    ```

2. 批量格式

    ```go
    var (
        a int
        b string
        c [] float32
        d func() bool
        e struct {
            x int
        }

    )

    ```

#### 1.1.2 初始化变量

Go语言在声明变量时，自动对变量的内存区进行初始化操作。每个变量会初始化其类型的默认值，例如：

- 整型和浮点型变量的默认值为0
- 字符串变量的默认值为空字符串
- 布尔型变量的默认为book
- 切片、函数、指针变量的默认为nil

声明变量的格式

1. 标准格式

    ```go
    var 变量名 类型 = 表达式

    var num int = 2
    ```

2. 编译器推导类型格式

    ```go
    var 变量名 = 表达式

    var num = 2
    ```

3. 短变量声明初始化

    此类推导声明写法的左值变量必须是没有定义过的变量。若定义过，将会发生编译错误。

    ```go
    num := 2
    ```

#### 1.1.3 多个变量同时赋值

多重赋值时，变量的左值和右值按从左到右的顺序赋值。多重赋值在Go语言的错误处理和函数返回值中会大量的使用。

```go
var a int = 100
var b int = 200
b, a = a, b
```

#### 1.1.4 匿名变量

在使用多重赋值时，如果不需要在左值中接收变量，可以使用匿名变量。匿名变量的表现时一个 "`_`"下划线。

```go

func GetData()(int, int){
    return 100, 200
}

a, _ := GetData()

_, b := GetData()
```

### 1.2 数据类型

Go语言中有丰富的数据类型，除了基本的整型、浮点型、布尔型、字符串外，还有切片、结构体、函数、map、通道（channel）等。

#### 1.2.1 整型

整型分为两大类

- 按长度分为：int8、int16、int32、int64
- 对应的无符号整型： uint8、uint16、uint32、uint64

uint8 -> byte型

int16 -> C语言的 short型

int64 -> C语言的 long型

1. 自动匹配平台的int和uint

    Go语言自动匹配特定平台整型长度的类型———— int和uint

2. 哪些情况下使用int和uint

    逻辑对整型范围没有特殊需求。

#### 1.2.2 浮点型

Go语言支持两种浮点数 float32和flaot64.

- float32

    最大范围为3.4e38，可以使用常量定义 `math.MaxFloat32`

- float64

     最大范围为1.8の08，可以使用常量定义 `math.MaxFloat64`

#### 1.2.3 输出正弦函数

```GO
package main

import (
	"image"
	"image/color"
	"image/png"
	"log"
	"math"
	"os"
)

func gen_Sin() {
	// 图片大小
	const size = 300

	// 根据给定大小创建灰度图
	pic := image.NewGray(image.Rect(0, 0, size, size))

	for x := 0; x < size; x++ {
		for y := 0; y < size; y++ {
			pic.SetGray(x, y, color.Gray{255})
		}
	}

	for x := 0; x < size; x++ {
		// sin 值的范围 0 - 2Pi 之间
		s := float64(x) * 2 * math.Pi / size
		y := size/2 - math.Sin(s)*size/2
		pic.SetGray(x, int(y), color.Gray{0})
	}

	file, err := os.Create("sin.png")
	if err != nil {
		log.Fatal("Create file failed \n", err)
	}
	png.Encode(file, pic)
	file.Close()

}
func main() {
	gen_Sin()
}
```

#### 1.2.4 布尔型

布尔类型数据在Go语言中以`bool` 类型进行声明，布尔类型只有 true（真）和false（假）两个值

布尔值不能参与数值运算，也无法与其他类型进行转换

```go
var n bool
```

#### 1.2.5 字符串

字符串在Go语言中以原生数据类型出现，使用字符串就像使用其他原生数据类型（int、bool、float32、float64）一样

```go
str := "Hello World!\n"
ch := "你好，世界！\n"
```

1. 字符串转义符
    Go语言的字符串常见转义符包含回车、换行、单双引号、
    制表符等
    
    | 转义符 | 含义|
    |:--------:| :---:|
    |\r     |   回车符|
    |\n     |   换行符|
    |\t     |   制表符|
    |\'     |   单引号|
    |\"     |   双引号|
    |\\     |   反斜杠|

2. 定义多行字符串

一般用于内嵌源码或内嵌数据

```go
const codeTemplate = `// Generated by github.com
        // 你好
        // hello world
`
```
#### 1.2.6 字符

字符串中的每一个元素叫做“字符”。 在遍历或者单个获取字符串元素时可以获得字符。

Go语言的字符有以下几种

- uint8类型，或者叫 byte，代表 ASCII码中的一个字符
- rune类型，代表一个UTF-8 字符。当需要处理中文时、日文或其他复合字符时，则需要用到rune类型。rune类型实际是一个int32.
    ```go
    import "fmt"


    func main()  {
        var a byte = 'a'
        fmt.Printf("%d %T\n", a, a)

        var b rune = '你'
        fmt.Printf("%d %T\n", b, b)
        
    }

    // 结果
    // 97 uint8
    // 20320 int32
    ```

#### 1.2.7 切片

切片时一个拥有相同类型元素的可变长度的序列。

声明方式

```go
var name []T

a := make([]int, 3)

a[0] = 1
a[1] = 2
a[2] = 3


str := "hello world"
fmt.Println(str[6:])
```

### 1.3 转换不同的数据类型

转换格式

```go
T(表达式)
```

```go
package main

import (
	"fmt"
	"math"
)


func main()  {
	// 输出各数值范围
	fmt.Println("int8 range:", math.MinInt8, math.MaxInt8)
	fmt.Println("int16 range:", math.MinInt16, math.MaxInt16)
	fmt.Println("int32 range:", math.MinInt32, math.MaxInt32)
	fmt.Println("int64 range:", math.MinInt64, math.MaxInt64)

	var a int32 = 1047483647
	fmt.Printf("int32: 0x %x %d\n", a, a)

	b := int16(a)

	fmt.Printf("int16: 0x %x %d\n", b, b)

	var c float32 = math.Pi
	fmt.Println(int(c))

}

"""
int8 range: -128 127
int16 range: -32768 32767
int32 range: -2147483648 2147483647
int64 range: -9223372036854775808 9223372036854775807
int32: 0x 3e6f54ff 1047483647
int16: 0x 54ff 21759
3
"""
```





